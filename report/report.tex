\RequirePackage[l2tabu, orthodox]{nag}
\documentclass[a4paper, oneside, notitlepage]{article}

\usepackage[english]{babel}
\usepackage{csquotes}
\usepackage{fullpage}
\usepackage{fixltx2e}
\usepackage{xspace}
\usepackage{relsize}
\usepackage{url}
\usepackage{enumitem}


\usepackage{booktabs}
\usepackage{ifthen}
\usepackage{siunitx}
\makeatletter
\g@addto@macro\@floatboxreset\centering %make all the floats center by default, do not use {center} env
\makeatother

% font stuff
\usepackage[T1]{fontenc}
\usepackage{microtype}
\usepackage{lmodern} \normalfont
% lmodern has no smallcaps bold , so we replace it by computer-modern (closely
% related)
\DeclareFontShape{T1}{lmr}{bx}{sc} { <-> ssub * cmr/bx/sc }{}
\usepackage[scaled=0.75]{beramono} % monospace font with bold support
\usepackage{pifont} % special chars
\newcommand{\tick}{\ding{51}}
\newcommand{\cross}{\ding{55}}


% nicely formatted acronyms 
\newcommand{\Rascal}{\textsc{Rascal}\xspace}


% todo marker
\usepackage[svgnames]{xcolor}
\usepackage{marginfix}
\newcommand{\todo}[1]{%
	\marginpar{%
	\colorbox{yellow}{\parbox{0.9\marginparwidth}{%
		\raggedright \footnotesize #1}}}}

\title{Domain mapping analysis}
\author{Davy Landman}

\usepackage{doi}
\usepackage{hyperref}
%\usepackage[sortcites, url=false, doi=true, useprefix=true, maxbibnames = 999, maxcitenames = 2]{biblatex}
%\bibliography{bibliography}

%\renewcommand*{\mkcitation}[1]{ #1} % remove annoying brackets around cites

%\newcommand{\citea}[1]{\citeauthor{#1}~\cite{#1}\xspace}

\begin{document}

\section{Data}
\newcommand{\modelDetails}[4]{#1 & #2 & #3 & #4 \\}
\begin{table}[htb]
	\caption{Domain Model details}
	\begin{tabular}{l *{3}{r}}\toprule
		Model source & \# Entities & \# assocations & \# attributes \\ \midrule
		\input{../src/models.tex}
		\bottomrule
	\end{tabular}
\end{table}


\begin{table}[htb]
	\caption{Domain Model entity mapping}
	\begin{tabular}{l r r p{7cm}}\toprule
		Mapping kind & Endeavour & OpenPM & Explanation \\ \midrule
		\input{../src/systems-mapping.tex}
		\bottomrule
	\end{tabular}
\end{table}

\newcommand\entityMapping[9]{%
	\gdef\entityName{#1}%
    \gdef\inEndeavour{#2}%
    \gdef\inOpenPM{#3}%
    \gdef\endOverlap{#4}%
    \gdef\endReferenceSize{#5}%
    \gdef\endTargetSize{#6}%
    \gdef\endSimularity{#7}%
    \gdef\opmOverlap{#8}%
    \gdef\opmReferenceSize{#9}%
	\entityMappingContinued
}
\newcommand{\entityMappingContinued}[2]{
    \gdef\opmTargetSize{#1}%
    \gdef\opmSimularity{#2}%
	\entityName & %
		\ifthenelse{\equal{true}{\inEndeavour}}{%
			\tick & \endTargetSize & \endOverlap & \endReferenceSize &
			\num{\endSimularity} & %
		}{%
			\cross & \multicolumn{4}{c}{--} &
		}%
		\ifthenelse{\equal{true}{\inOpenPM}}{%
			\tick & \opmTargetSize & \opmOverlap & \opmReferenceSize & \opmSimularity \\ %
		}{%
			\cross & \multicolumn{4}{c}{--} \\
		}%
}
\begin{table}[htb]
	\caption{Model association similarity with reference model
		\label{TableResultsChapter3}}
	{\footnotesize
	\begin{tabular}{l *{2}{c *{4}{r}}}\toprule
		Entity & \multicolumn{5}{c}{Endeavour} & \multicolumn{5}{c}{OpenPM} \\ \cmidrule(l){2-11}
		 & \textsmaller{Exists} & \textsmaller{Total \#} 
		 	& \textsmaller{$\cap$ \#} & \textsmaller{Ref \#} 
			& \textsmaller{Similarity}
		 & \textsmaller{Exists} & \textsmaller{Total \#} 
		 	& \textsmaller{$\cap$ \#} & \textsmaller{Ref \#} 
			& \textsmaller{Similarity} \\
		\midrule

		\input{../src/result.tex}

		\bottomrule
	\end{tabular}
	}
\end{table}	

\section{Observations}

\begin{itemize}
	\item Most \textsmaller{OSS} systems used the \textsmaller{MVC} pattern,
	which has an explicit model part.

	\item About 85\% (estimated) of the model was recovered by automatic
	extraction from \textsmaller{JDT} facts using \Rascal.

	\item Can we infer the model from the database?

	\item No process around the data was in the source code. But this might be
	related that these systems are used for storing the results of planning, not
	for performing the actual planning.

	\item Is \textsmaller{OSS} a good source for the problem we are trying to
	solve? Developers are more motivated for nice design? Or just to small
	systems?

\end{itemize}
\end{document}
